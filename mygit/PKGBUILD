pkgname='mygit'
pkgver='0.1.0'
pkgrel='3'
pkgdesc='Simple self-hosted git server, written in Rust.'
arch=('x86_64' 'armv7h')
url='https://git.alexwennerberg.com/mygit'
license=('AGPL-3.0')
makedepends=('git' 'cargo')
provides=($pkgname)
conflicts=($pkgname)
source=("git+ssh://mercure.home:/srv/git/gavrois/${pkgname}.git"
	"${pkgname}.service")
sha256sums=('SKIP' 'SKIP')

build() {
	cd $pkgname
	cargo build --release --target-dir=target
}

package() {
	install -Dm644 $srcdir/mygit.service -t $pkgdir/usr/lib/systemd/system/

	install -Dm755 $srcdir/$pkgname/target/release/$pkgname -t $pkgdir/usr/bin/
	install -Dm755 $srcdir/$pkgname/mygit.toml -t $pkgdir/etc/
}
